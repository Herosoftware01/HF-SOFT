{% extends 'mains.html' %}

{% load static %}
{% load dict_extras %}
{% block content %}
<div class="bg-[url('{% static 'images/blue.jpg' %}')] bg-cover bg-center bg-no-repeat p-6 min-h-screen">

    <div class="max-w-6xl mx-auto bg-white shadow-lg rounded-lg p-6">
        <h1 class="text-2xl font-bold mb-4 text-center font-sans">User List</h1>
       <!-- <div id="server-options" class="space-x-4 flex flex-row">
            <p class="font-bold mr-2">Select Server</p>
            <label class="flex items-center space-x-2">
                <input type="checkbox" name="server" value="1" class="form-checkbox text-blue-600" onclick="onlyOne(this)">
                <span>Server 10</span>
            </label>

            <label class="flex items-center space-x-2">
                <input type="checkbox" name="server" value="2" class="form-checkbox text-blue-600" onclick="onlyOne(this)">
                <span>Server 13</span>
            </label>
             <label class="flex items-center space-x-2">
                <input type="checkbox" name="server" value="2" class="form-checkbox text-blue-600" onclick="onlyOne(this)">
                <span>Server 15</span>
            </label>
           
        </div> -->

           

        <div class="overflow-x-auto">
            <form method="post" action="">
                {% csrf_token %}
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Username</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">admin</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Roll check</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Attendance</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">PowerBi Data</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Production Stock</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">lay_spreading</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">lay_admin</th>
                        <!-- <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">mobile_app</th> -->
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">unit 1</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">unit 2</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">unit 3</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">unit 4</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">unit 5</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Merch 1</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Merch 2</th>
                    </tr>
                </thead>
                <!-- <tbody class="bg-white divide-y divide-gray-200">
                    {% for user in users %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ user.username }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><input type="checkbox">admin control</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><input type="checkbox">Roll check</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><input type="checkbox">Attendance</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-center py-4 text-gray-500">No users found.</td>
                    </tr>
                    {% endfor %}
                </tbody> -->
            
            <tbody class="bg-white divide-y divide-gray-200">
    {% for user in users %}
        {% with permission=permissions|get_item:user.id %}
        <tr class="hover:bg-gray-50">
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                {{ user.username }}
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="admin_{{ user.id }}"
                       {% if permission.can_access_admin %}checked{% endif %}>
                Admin control
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="roll_{{ user.id }}"
                       {% if permission.can_access_roll %}checked{% endif %}>
                Roll check
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="attendance_{{ user.id }}"
                       {% if permission.can_access_attendance %}checked{% endif %}>
                Attendance
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="powerbi_data_{{ user.id }}"
                       {% if permission.powerbi_data %}checked{% endif %}>
                PowerBi Data
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="production_data_{{ user.id }}"
                       {% if permission.production_data %}checked{% endif %}>
                Production stock
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="lay_spreading_{{ user.id }}"
                       {% if permission.lay_spreading %}checked{% endif %}>
                lay_spreading
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="lay_admin_{{ user.id }}"
                       {% if permission.lay_admin %}checked{% endif %}>
                lay_admin
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="unit1_{{ user.id }}"
                       {% if permission.unit1 %}checked{% endif %}>
                unit1
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="unit2_{{ user.id }}"
                       {% if permission.unit2 %}checked{% endif %}>
                unit2
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="unit3_{{ user.id }}"
                       {% if permission.unit3 %}checked{% endif %}>
                unit3
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="unit4_{{ user.id }}"
                       {% if permission.unit4 %}checked{% endif %}>
                unit4
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="unit5_{{ user.id }}"
                       {% if permission.unit5 %}checked{% endif %}>
                unit5
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="merch1_{{ user.id }}"
                       {% if permission.merch1 %}checked{% endif %}>
                merch1
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="checkbox" name="merch2_{{ user.id }}"
                       {% if permission.merch2 %}checked{% endif %}>
                merch2
            </td>
           
        </tr>
        {% endwith %}
    {% empty %}
        <tr>
            <td colspan="4" class="text-center py-4 text-gray-500">No users found.</td>
        </tr>
    {% endfor %}
</tbody>
            
            </table>
            <button type="submit" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded">Save Permissions</button>
            </form>
        </div>
    </div>

</div>


 <script>
function onlyOne(checkbox) {
    const checkboxes = document.getElementsByName('server');
    checkboxes.forEach((item) => {
    if (item !== checkbox) item.checked = false;
    });
}
</script>

{% endblock %}

